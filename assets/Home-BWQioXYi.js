var k=Object.defineProperty;var A=(l,e,a)=>e in l?k(l,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[e]=a;var r=(l,e,a)=>A(l,typeof e!="symbol"?e+"":e,a);import{_ as H,r as g,o as B,a as v,c as x,b as y,n as z,d as M}from"./index-DOtZameM.js";let S=class{constructor(e){r(this,"src",null);r(this,"height",null);r(this,"colors",[]);r(this,"strokeColor","");r(this,"strokeWidth",0);r(this,"audioContext",null);r(this,"audioContextObj",null);r(this,"analyserFftSize",8192);r(this,"canvas",null);r(this,"canvasWidth",0);r(this,"canvasHeight",0);r(this,"centerX",0);r(this,"centerY",0);r(this,"maxBarHeight",0);r(this,"radius",0);this.src=e.src,this.height=e.height,this.colors=e.colors,this.strokeColor=e.strokeColor,this.strokeWidth=e.strokeWidth}createAudioElement(){const e=document.createElement("audio");return e.id=1,e.src=this.src,e.crossOrigin="anonymous",e.controls=!0,e.loop="true",e.dataset.action="off",e.style.display="none",e}createAudioContextObj(e){this.audioContext=new AudioContext;const a=this.audioContext.createMediaElementSource(e),s=this.audioContext.createAnalyser();a.connect(s),s.connect(this.audioContext.destination),s.fftSize=this.analyserFftSize;const t=s.frequencyBinCount;let o={freqData:new Uint8Array(t),analyser:s};return this.audioContextObj=o,o}getAudioContext(){return this.audioContext}getMaxBarHeight(){return this.maxBarHeight}setMaxBarHeight(e){this.maxBarHeight=e}calculateMaxBarHeight(){const e=Math.min(this.canvasWidth,this.canvasHeight)/4;this.setMaxBarHeight(e)}setRadius(e){this.radius=e}getRadius(){return this.radius}initCanvas(e,a,s){this.canvas=e,this.canvasWidth=a.clientWidth,s==="100%"?this.canvasHeight=a.parentElement.clientHeight:this.canvasHeight=a.clientHeight,this.canvas.setAttribute("width",this.canvasWidth),this.canvas.setAttribute("height",this.canvasHeight),this.centerX=e.width/2,this.centerY=e.height/2}renderFrame(){const e=this.audioContextObj,a=200,s=[],t=[];let n=Object.values(e),o=e.freqData;if(e.analyser.getByteFrequencyData(o),s.push(o),n.length>0){for(let c=0;c<s[0].length;c++)t.push(0),s.forEach(d=>{t[c]+=d[c]});const u=[];let i=0;for(let c=0;c<a;c++){const d=t[c]*this.maxBarHeight/255;i=Math.max(i,d);const f=Math.PI*2/a,m=this.centerX+Math.cos(f*c)*(this.radius+d),_=this.centerY+Math.sin(f*c)*(this.radius+d);u.push({x:m,y:_})}this.renderCanvas(u,i)}}renderCanvas(e,a){const s=this.canvas,t=s.getContext("2d");t.clearRect(0,0,s.width,s.height),t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let n=0;n<e.length;n++){const o=(n+1)%e.length,u=(e[n].x+e[o].x)/2,i=(e[n].y+e[o].y)/2;t.quadraticCurveTo(e[n].x,e[n].y,u,i)}if(t.quadraticCurveTo(e[0].x,e[0].y,e[0].x,e[0].y),t.closePath(),t.save(),t.clip(),!this.colors.length)t.fillStyle="rgb(0, 191, 179)",t.fillRect(0,0,s.width,s.height);else if(this.colors.length===1)t.fillStyle=this.colors[0],t.fillRect(0,0,s.width,s.height);else{const n=t.createRadialGradient(this.centerX,this.centerY,0,this.centerX,this.centerY,this.radius+a),o=1/this.colors.length;this.colors.forEach((u,i)=>{n.addColorStop(i*o,u)}),t.fillStyle=n,t.fillRect(0,0,s.width,s.height)}t.restore(),t.lineWidth=this.strokeWidth,t.strokeStyle=this.strokeColor,t.stroke()}};const q={key:0,class:"material-icons"},V={key:1,class:"material-icons"},W=Object.assign({name:"AudioVisualizer"},{__name:"Vuesializer",props:{src:{type:String,required:!0},height:{type:String,default:"100%"},colors:{type:Array,default:()=>[]},strokeColor:{type:String,default:"rgba(0, 191, 179, 1)"},strokeWidth:{type:Number,default:1}},setup(l){const e=l,a=g(null),s=g(null),t=g(null),n=g(null),o=g(!1),u=g(!0),i=new S(e);B(()=>{i.initCanvas(t.value,n.value,e.height),i.calculateMaxBarHeight(),c(),a.value&&d()});const c=()=>{const h=i.createAudioElement();s.value.append(h),a.value=h};function d(){i.createAudioContextObj(a.value),f()}function f(){i.renderFrame(),requestAnimationFrame(f)}function m(h){const C=()=>{const b=i.getRadius(),p=h-b;Math.abs(p)<1?i.setRadius(h):o.value?(i.setRadius(b+p/10),requestAnimationFrame(C)):i.setRadius(h)};requestAnimationFrame(C)}const _=()=>{const h=i.getAudioContext();o.value=!0,setTimeout(()=>{o.value=!1},1e3),a.value.paused?(a.value.play(),h.state==="suspended"&&h.resume(),m(i.getMaxBarHeight())):(a.value.pause(),m(0)),u.value=a.value.paused};return(h,C)=>(v(),x("div",{ref_key:"wrapper",ref:n,class:"Vuesializer",style:z({"--height":l.height})},[y("button",{class:"Vuesializer__play-btn",onClick:_},[u.value?(v(),x("span",q,"play_arrow")):(v(),x("span",V,"pause"))]),y("div",{ref_key:"audioContainer",ref:s},null,512),y("canvas",{ref_key:"canvas",ref:t},null,512)],4))}}),w=H(W,[["__scopeId","data-v-7e3215db"]]),E={class:"page"},O={class:"page__wrapper"},R=Object.assign({name:"Home"},{__name:"Home",setup(l){return(e,a)=>(v(),x("div",E,[y("div",O,[M(w,{src:"/Vuesializer/audio.mp3",colors:["rgba(0, 191, 179, 0.0)","rgba(0, 191, 179, 0.15)"],class:"Vuesializer"})])]))}}),X=H(R,[["__scopeId","data-v-6c653e33"]]);export{X as default};
