var k=Object.defineProperty;var A=(l,e,s)=>e in l?k(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var r=(l,e,s)=>A(l,typeof e!="symbol"?e+"":e,s);import{_ as H,r as g,o as B,a as v,c as x,b as y,n as z,d as M,e as S}from"./index-C_4PXUXY.js";let q=class{constructor(e){r(this,"src",null);r(this,"height",null);r(this,"colors",[]);r(this,"strokeColor","");r(this,"strokeWidth",0);r(this,"audioContext",null);r(this,"audioContextObj",null);r(this,"analyserFftSize",8192);r(this,"canvas",null);r(this,"canvasWidth",0);r(this,"canvasHeight",0);r(this,"centerX",0);r(this,"centerY",0);r(this,"maxBarHeight",0);r(this,"radius",0);this.src=e.src,this.height=e.height,this.colors=e.colors,this.strokeColor=e.strokeColor,this.strokeWidth=e.strokeWidth}createAudioElement(){const e=document.createElement("audio");return e.id=1,e.src=this.src,e.crossOrigin="anonymous",e.controls=!0,e.loop="true",e.dataset.action="off",e.style.display="none",e}createAudioContextObj(e){this.audioContext=new AudioContext;const s=this.audioContext.createMediaElementSource(e),a=this.audioContext.createAnalyser();s.connect(a),a.connect(this.audioContext.destination),a.fftSize=this.analyserFftSize;const t=a.frequencyBinCount;let o={freqData:new Uint8Array(t),analyser:a};return this.audioContextObj=o,o}getAudioContext(){return this.audioContext}getMaxBarHeight(){return this.maxBarHeight}setMaxBarHeight(e){this.maxBarHeight=e}calculateMaxBarHeight(){const e=Math.min(this.canvasWidth,this.canvasHeight)/4;this.setMaxBarHeight(e)}setRadius(e){this.radius=e}getRadius(){return this.radius}initCanvas(e,s,a){this.canvas=e,this.canvasWidth=s.clientWidth,a==="100%"?this.canvasHeight=s.parentElement.clientHeight:this.canvasHeight=s.clientHeight,this.canvas.setAttribute("width",this.canvasWidth),this.canvas.setAttribute("height",this.canvasHeight),this.centerX=e.width/2,this.centerY=e.height/2}renderFrame(){const e=this.audioContextObj,s=200,a=[],t=[];let n=Object.values(e),o=e.freqData;if(e.analyser.getByteFrequencyData(o),a.push(o),n.length>0){for(let c=0;c<a[0].length;c++)t.push(0),a.forEach(d=>{t[c]+=d[c]});const h=[];let i=0;for(let c=0;c<s;c++){const d=t[c]*this.maxBarHeight/255;i=Math.max(i,d);const f=Math.PI*2/s,m=this.centerX+Math.cos(f*c)*(this.radius+d),_=this.centerY+Math.sin(f*c)*(this.radius+d);h.push({x:m,y:_})}this.renderCanvas(h,i)}}renderCanvas(e,s){const a=this.canvas,t=a.getContext("2d");t.clearRect(0,0,a.width,a.height),t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let n=0;n<e.length;n++){const o=(n+1)%e.length,h=(e[n].x+e[o].x)/2,i=(e[n].y+e[o].y)/2;t.quadraticCurveTo(e[n].x,e[n].y,h,i)}if(t.quadraticCurveTo(e[0].x,e[0].y,e[0].x,e[0].y),t.closePath(),t.save(),t.clip(),!this.colors.length)t.fillStyle="rgb(0, 191, 179)",t.fillRect(0,0,a.width,a.height);else if(this.colors.length===1)t.fillStyle=this.colors[0],t.fillRect(0,0,a.width,a.height);else{const n=t.createRadialGradient(this.centerX,this.centerY,0,this.centerX,this.centerY,this.radius+s),o=1/this.colors.length;this.colors.forEach((h,i)=>{n.addColorStop(i*o,h)}),t.fillStyle=n,t.fillRect(0,0,a.width,a.height)}t.restore(),t.lineWidth=this.strokeWidth,t.strokeStyle=this.strokeColor,t.stroke()}};const V={key:0,class:"material-icons"},W={key:1,class:"material-icons"},w=Object.assign({name:"AudioVisualizer"},{__name:"Vuesializer",props:{src:{type:String,required:!0},height:{type:String,default:"100%"},colors:{type:Array,default:()=>[]},strokeColor:{type:String,default:"rgba(0, 191, 179, 1)"},strokeWidth:{type:Number,default:1}},setup(l){const e=l,s=g(null),a=g(null),t=g(null),n=g(null),o=g(!1),h=g(!0),i=new q(e);B(()=>{i.initCanvas(t.value,n.value,e.height),i.calculateMaxBarHeight(),c(),s.value&&d()});const c=()=>{const u=i.createAudioElement();a.value.append(u),s.value=u};function d(){i.createAudioContextObj(s.value),f()}function f(){i.renderFrame(),requestAnimationFrame(f)}function m(u){const C=()=>{const p=i.getRadius(),b=u-p;Math.abs(b)<1?i.setRadius(u):o.value?(i.setRadius(p+b/10),requestAnimationFrame(C)):i.setRadius(u)};requestAnimationFrame(C)}const _=()=>{const u=i.getAudioContext();o.value=!0,setTimeout(()=>{o.value=!1},1e3),s.value.paused?(s.value.play(),u.state==="suspended"&&u.resume(),m(i.getMaxBarHeight())):(s.value.pause(),m(0)),h.value=s.value.paused};return(u,C)=>(v(),x("div",{ref_key:"wrapper",ref:n,class:"Vuesializer",style:z({"--height":l.height})},[y("button",{class:"Vuesializer__play-btn",onClick:_},[h.value?(v(),x("span",V,"play_arrow")):(v(),x("span",W,"pause"))]),y("div",{ref_key:"audioContainer",ref:a},null,512),y("canvas",{ref_key:"canvas",ref:t},null,512)],4))}}),E=H(w,[["__scopeId","data-v-7e3215db"]]),O={class:"page"},R={class:"page__wrapper"},j=Object.assign({name:"Home"},{__name:"Home",setup(l){const e=M(()=>"/Vuesializer/audio.mp3");return(s,a)=>(v(),x("div",O,[y("div",R,[S(E,{src:e.value,colors:["rgba(0, 191, 179, 0.0)","rgba(0, 191, 179, 0.15)"],class:"Vuesializer"},null,8,["src"])])]))}}),Y=H(j,[["__scopeId","data-v-5a6c20c8"]]);export{Y as default};
